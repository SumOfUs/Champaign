{% if plugins.call_tool[ref].active %}
  <h1> Call Tool </h1>

  <form class='action-form' >
    <div class="sweet-placeholder">
      <label>Phone Number</label>
      <input type="tel" name="action[phone_number]" class="" value="" />
    </div>

    <div class="sweet-placeholder">
      <label>Country</label>
      <select name="{{field.name}}" class="action-form__dropdown form__content sweet-placeholder__field selectize">
        <option></option>
        <option value='{{"ARG"}}'>{{"Argentina"}}</option>
        <option value='{{"CHL"}}'>{{"Chile"}}</option>
      </select>
    </div>

    <div class="action-form__target">
      <p>
        <strong> Target: </strong>
        <span> </span>
      </p>
    </div>

    <button type="submit" class="button action-form__submit-button">{{ "Submit" }}</button>
  </form>

  <script>
    $(document).ready(function() {
      var form = $('form.action-form');
      var phoneInput = form.find('input[type=tel]');
      var submitButton = form.find('button[type=submit]');
      var pageId = window.champaign.personalization.urlParams.id;

      submitButton.click(function(e) {
        e.preventDefault();

        var data = {
          call: {
            phone: phoneInput.val()
          }
        }

        $.post(`/api/pages/${this.pageId}/call`, data)
          .then(callCreationSuccess, callCreationFailed);
      });

      function callCreationSuccess(data) {
        console.log("Call creation succeeded");
        console.log(data);
      }

      function callCreationFailed(data, status) {
        console.log("Call creation failed");
        console.log(status);
        console.log(data);
      }
    });
  </script>
{% endif %}
